cmake_minimum_required(VERSION 3.13)

# Get parent directory and set SDK paths
get_filename_component(PARENT_DIR ${CMAKE_CURRENT_LIST_DIR} DIRECTORY)
set(PICO_SDK_PATH ${PARENT_DIR}/pico-sdk)
set(PICO_EXTRAS_PATH ${PARENT_DIR}/pico-extras)

# Include SDK setup scripts
include(${PICO_SDK_PATH}/external/pico_sdk_import.cmake)
include(${PICO_EXTRAS_PATH}/external/pico_extras_import.cmake)

# Project setup
project(pico_http_server C CXX ASM)
set(PICO_BOARD pico_w)
pico_sdk_init()

# Add executable and dependencies
add_executable(server main.c src/request.c src/response.c)
target_include_directories(server PRIVATE
    ${CMAKE_CURRENT_LIST_DIR}
    ${PICO_SDK_PATH}/lib/lwip/src/include
    ${CMAKE_CURRENT_LIST_DIR}/inc
)
target_link_libraries(server 
    pico_stdlib
    pico_cyw43_arch_lwip_threadsafe_background
    pico_lwip
    hardware_flash
)
pico_add_extra_outputs(server)